jQuery(function (t) { var i = []; function n() { t(document).off("click", ".qib-button").on("click", ".qib-button", function () { var n = t(this).siblings(".quantity").find(".qty"), e = parseFloat(n.val()), o = parseFloat(n.attr("max")), s = parseFloat(n.attr("min")), r = parseFloat(n.attr("step")), u = t(this).parent(), l = t(u).prev().attr("data-product_id"); if (1 == i[l]) if (i[l] = !1, t(this).is(".plus")) { if (e === o) return i[l] = !0, !1; isNaN(e) ? n.val(r) : e + r > o ? (n.val(o), i[l] = !0) : (n.val(e + r), a(l, e + r, "plus", this)) } else if (t(this).is(".minus")) { if (e === s) return a(l, 0, "minus", this), !1; isNaN(e) ? (i[l] = !0, n.val(s)) : e - r < s ? (n.val(s), i[l] = !0) : (n.val(e - r), a(l, e - r, "minus", this)) } n.val(Math.round(100 * n.val()) / 100), n.trigger("change"), t("body").removeClass("sf-input-focused") }) } function a(n, a, s, r, u = !1) { !function (i) { var n = t(i).siblings(".quantity"); t(n).addClass("button loading disabled") }(r), t.post(ArabindaCool.ajaxurl, { action: "arabinda_add_to_cart", id: n, quantity: a, type: s }).done(function (l) { if (l) 0 == a ? function (i) { var n = t(i).parent(); t(n).hide(); var a = jQuery(n).prev(); t(a).show() }(r) : u && o(!1, r), e(r, l, u); else { if (u && o(!0, r), a > 1) e(r, "minus" == s ? a + 1 : a - 1); alert("Oops handle broken, let me fix it in a while :)") } !function (i) { var n = t(i).siblings(".quantity "); t(n).removeClass("button loading disabled") }(r), i[n] = !0 }) } function e(i, n, a) { if (a) { var e = t(i).next(); i = t(e).find(".plus") } t(i).siblings(".quantity").find(".qty").val(n) } function o(i, n) { var a = n; if (i) t(a).removeClass("loading"); else { t(a).removeClass("loading"), t(a).hide(); var e = jQuery(a).next(); t(e).show() } } t(document).ready(function () { n() }), t(document).ajaxComplete(function () { n() }), jQuery(document).on("click", ".quantity input", function () { return t(this).keydown(function (t) { return !1 }), !1 }), jQuery(document).on("click", ".increment_quantity_add_to_cart_button", function (n) { n.preventDefault(); var e = t(this).attr("data-product_id"); i.hasOwnProperty(e) && 1 != i[e] || (t(this).addClass("loading"), a(e, "1", "plus", this, !0)) }) });